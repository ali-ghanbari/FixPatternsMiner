Merge pull request #1782 from laurentg/fix-1781

Fix #1781. Removal of looping edges throws NPE.
