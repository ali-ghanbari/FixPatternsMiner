fix minor bug introduced by direction changes

