diff --git a/opentripplanner-graph-builder/src/main/java/org/opentripplanner/graph_builder/impl/reach/ReachMiniSPT.java b/opentripplanner-graph-builder/src/main/java/org/opentripplanner/graph_builder/impl/reach/ReachMiniSPT.java
index 538ca3f..591474a 100644
--- a/opentripplanner-graph-builder/src/main/java/org/opentripplanner/graph_builder/impl/reach/ReachMiniSPT.java
+++ b/opentripplanner-graph-builder/src/main/java/org/opentripplanner/graph_builder/impl/reach/ReachMiniSPT.java
@@ -201 +201 @@
-                Double maxHeight = outPenalty.get(state);
+                Double maxHeight = outPenalty.get(state.getVertex());

