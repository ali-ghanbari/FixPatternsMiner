diff --git a/modules/xdr/src/main/java/org/dcache/xdr/Xdr.java b/modules/xdr/src/main/java/org/dcache/xdr/Xdr.java
index ae687fe..e5c17d0 100644
--- a/modules/xdr/src/main/java/org/dcache/xdr/Xdr.java
+++ b/modules/xdr/src/main/java/org/dcache/xdr/Xdr.java
@@ -356 +356 @@
-                Buffer addon = MemoryManager.DEFAULT_MEMORY_MANAGER.allocate(size - _body.capacity());
+                Buffer addon = MemoryManager.DEFAULT_MEMORY_MANAGER.allocate(newCapacity - _body.capacity());

