fixed issues, tests pass again

