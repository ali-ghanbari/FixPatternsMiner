fix small bugs and add sort predicates

