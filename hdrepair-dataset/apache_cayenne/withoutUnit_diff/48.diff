diff --git a/framework/cayenne-jpa-unpublished/src/main/java/org/apache/cayenne/jpa/ResourceLocalEntityManager.java b/framework/cayenne-jpa-unpublished/src/main/java/org/apache/cayenne/jpa/ResourceLocalEntityManager.java
index ce72296..fff2ce6 100644
--- a/framework/cayenne-jpa-unpublished/src/main/java/org/apache/cayenne/jpa/ResourceLocalEntityManager.java
+++ b/framework/cayenne-jpa-unpublished/src/main/java/org/apache/cayenne/jpa/ResourceLocalEntityManager.java
@@ -257 +257 @@
-        return p.getObjectContext() == context;
+        return p.getObjectContext().getGraphManager().getNode(p.getObjectId()) == p;

