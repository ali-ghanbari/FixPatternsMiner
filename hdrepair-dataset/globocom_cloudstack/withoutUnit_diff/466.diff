diff --git a/cloud.spec b/cloud.spec
index f791486..b0eedb1 100644
--- a/cloud.spec
+++ b/cloud.spec
@@ -224 +223,0 @@
-Requires: jnetpcap
@@ -306,0 +306 @@
+Requires: jnetpcap
diff --git a/server/src/com/cloud/template/TemplateManagerImpl.java b/server/src/com/cloud/template/TemplateManagerImpl.java
index 2388930..c5e80bf 100755
--- a/server/src/com/cloud/template/TemplateManagerImpl.java
+++ b/server/src/com/cloud/template/TemplateManagerImpl.java
@@ -830 +830 @@
-        if ( !attach ) {
+        if ( success && !attach ) {

