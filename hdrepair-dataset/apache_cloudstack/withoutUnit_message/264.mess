Propagating fixes to testClient from 3.0.x. Resolving conflicts
reviewed-by: Prasanna

