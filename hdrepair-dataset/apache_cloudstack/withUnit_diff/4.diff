diff --git a/utils/src/com/cloud/utils/PropertiesUtil.java b/utils/src/com/cloud/utils/PropertiesUtil.java
index 6db66ff..6f3796a 100755
--- a/utils/src/com/cloud/utils/PropertiesUtil.java
+++ b/utils/src/com/cloud/utils/PropertiesUtil.java
@@ -133 +133 @@
-                    preProcessedCommands.load(new FileInputStream(commandsFile));
+                    loadFromFile(preProcessedCommands, commandsFile);
diff --git a/utils/test/com/cloud/utils/PropertiesUtilsTest.java b/utils/test/com/cloud/utils/PropertiesUtilsTest.java
index 5ebe095..d27a0b4 100644
--- a/utils/test/com/cloud/utils/PropertiesUtilsTest.java
+++ b/utils/test/com/cloud/utils/PropertiesUtilsTest.java
@@ -20,0 +21 @@
+import java.util.Map;
@@ -32,0 +34 @@
+
@@ -40,0 +43,11 @@
+
+    @Test
+    public void processConfigFile() throws IOException {
+        File tempFile = File.createTempFile("temp", ".properties");
+        FileUtils.writeStringToFile(tempFile, "a=b\nc=d\n");
+        Map<String, String> config = PropertiesUtil
+                .processConfigFile(new String[] { tempFile.getAbsolutePath() });
+        Assert.assertEquals("b", config.get("a"));
+        Assert.assertEquals("d", config.get("c"));
+        tempFile.delete();
+    }

