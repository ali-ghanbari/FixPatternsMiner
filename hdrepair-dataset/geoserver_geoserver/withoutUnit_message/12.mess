merging master and fixing minor problems

