diff --git a/src/com/sun/jna/Structure.java b/src/com/sun/jna/Structure.java
index 5035dfc..2c567fb 100644
--- a/src/com/sun/jna/Structure.java
+++ b/src/com/sun/jna/Structure.java
@@ -1290 +1290 @@
-        return toString(0, true, true);
+        return toString(0, true, debug);
diff --git a/test/com/sun/jna/StructureTest.java b/test/com/sun/jna/StructureTest.java
index cad209e..2c4f21c 100644
--- a/test/com/sun/jna/StructureTest.java
+++ b/test/com/sun/jna/StructureTest.java
@@ -1146,0 +1147,4 @@
+
+        System.setProperty("jna.dump_memory", "false");
+        assertFalse("Doesn't dump memory when jna.dump_memory is false",
+                   s.toString().contains("memory dump"));

