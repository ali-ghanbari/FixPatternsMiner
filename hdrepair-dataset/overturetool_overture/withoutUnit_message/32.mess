New type checking too tough on higher order polymorphic functions,
fixes #337

