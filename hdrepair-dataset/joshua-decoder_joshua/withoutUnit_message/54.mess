bugfix: off-by-one error in doing substring

