diff --git a/ethereumj-core/src/main/java/org/ethereum/net/rlpx/FrameCodec.java b/ethereumj-core/src/main/java/org/ethereum/net/rlpx/FrameCodec.java
index bbeee7e..936aa25 100644
--- a/ethereumj-core/src/main/java/org/ethereum/net/rlpx/FrameCodec.java
+++ b/ethereumj-core/src/main/java/org/ethereum/net/rlpx/FrameCodec.java
@@ -157 +157 @@
-        byte[] macBuffer = new byte[macSize];
+        byte[] macBuffer = new byte[ingressMac.getDigestSize()];

