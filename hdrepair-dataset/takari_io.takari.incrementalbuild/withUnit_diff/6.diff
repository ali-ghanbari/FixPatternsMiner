diff --git a/incrementalbuild/src/main/java/io/takari/incrementalbuild/spi/DefaultBuildContext.java b/incrementalbuild/src/main/java/io/takari/incrementalbuild/spi/DefaultBuildContext.java
index a02f8e2..83c981a 100644
--- a/incrementalbuild/src/main/java/io/takari/incrementalbuild/spi/DefaultBuildContext.java
+++ b/incrementalbuild/src/main/java/io/takari/incrementalbuild/spi/DefaultBuildContext.java
@@ -752 +752 @@
-              putInputFileState(includedInput, oldState.getFileState(inputFile));
+              putInputFileState(includedInput, oldState.getFileState(includedInput));
diff --git a/incrementalbuild/src/test/java/io/takari/incremental/test/DefaultBuildContextTest.java b/incrementalbuild/src/test/java/io/takari/incremental/test/DefaultBuildContextTest.java
index 62a5735..48b62c7 100644
--- a/incrementalbuild/src/test/java/io/takari/incremental/test/DefaultBuildContextTest.java
+++ b/incrementalbuild/src/test/java/io/takari/incremental/test/DefaultBuildContextTest.java
@@ -278,0 +279 @@
+    Files.append("test", includedFile, Charsets.UTF_8);

