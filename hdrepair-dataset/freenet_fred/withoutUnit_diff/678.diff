diff --git a/src/freenet/node/IPDetectorPluginManager.java b/src/freenet/node/IPDetectorPluginManager.java
index 594798c..2396484 100644
--- a/src/freenet/node/IPDetectorPluginManager.java
+++ b/src/freenet/node/IPDetectorPluginManager.java
@@ -354,0 +355,2 @@
+			Peer peer = p.getPeer();
+			if(peer == null) continue;

