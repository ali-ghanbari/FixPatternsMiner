diff --git a/src/freenet/support/io/PersistentBlobTempBucketFactory.java b/src/freenet/support/io/PersistentBlobTempBucketFactory.java
index b3ea841..50e8252 100644
--- a/src/freenet/support/io/PersistentBlobTempBucketFactory.java
+++ b/src/freenet/support/io/PersistentBlobTempBucketFactory.java
@@ -192 +192 @@
-			if(tag.index > blocks) {
+			if(tag.index >= freeBlocksCache.getSize()) {

