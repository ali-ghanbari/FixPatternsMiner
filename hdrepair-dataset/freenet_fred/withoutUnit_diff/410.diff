diff --git a/src/freenet/clients/http/QueueToadlet.java b/src/freenet/clients/http/QueueToadlet.java
index e06beee..b454f90 100644
--- a/src/freenet/clients/http/QueueToadlet.java
+++ b/src/freenet/clients/http/QueueToadlet.java
@@ -1742 +1742 @@
-		return (!container.publicGatewayMode()) || ctx.isAllowedFullAccess();
+		return (!container.publicGatewayMode()) || ((ctx != null) && ctx.isAllowedFullAccess());

