Test fixes and lea extract works!

