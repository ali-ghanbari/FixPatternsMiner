Revert "Revert "fixes WriteValidator""

This reverts commit f4990d3d50a42738daa86a9359d01dd6bbf2be7b.

