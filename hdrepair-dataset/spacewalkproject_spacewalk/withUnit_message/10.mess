adapt the testcase and fix a issue catched by the testcase

