Merge w/ Michael's fixes

