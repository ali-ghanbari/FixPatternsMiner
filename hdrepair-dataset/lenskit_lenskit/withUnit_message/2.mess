Tests and bugfixes for starting at nonzero positions (#684)

