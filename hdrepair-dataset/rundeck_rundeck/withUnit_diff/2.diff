diff --git a/rundeck-launcher/rundeck-jetty-server/src/main/java/com/dtolabs/rundeck/jetty/jaas/JettyCachingLdapLoginModule.java b/rundeck-launcher/rundeck-jetty-server/src/main/java/com/dtolabs/rundeck/jetty/jaas/JettyCachingLdapLoginModule.java
index a892dfb..08fdcc1 100644
--- a/rundeck-launcher/rundeck-jetty-server/src/main/java/com/dtolabs/rundeck/jetty/jaas/JettyCachingLdapLoginModule.java
+++ b/rundeck-launcher/rundeck-jetty-server/src/main/java/com/dtolabs/rundeck/jetty/jaas/JettyCachingLdapLoginModule.java
@@ -102 +102 @@
-    private static final Pattern rolePattern = Pattern.compile("^cn=([^,]+)");
+    private static final Pattern rolePattern = Pattern.compile("^cn=([^,]+)", Pattern.CASE_INSENSITIVE);
diff --git a/rundeck-launcher/rundeck-jetty-server/src/test/java/com/dtolabs/rundeck/jetty/jaas/JettyCachingLdapLoginModuleTest.java b/rundeck-launcher/rundeck-jetty-server/src/test/java/com/dtolabs/rundeck/jetty/jaas/JettyCachingLdapLoginModuleTest.java
index 72631d3..d44e600 100644
--- a/rundeck-launcher/rundeck-jetty-server/src/test/java/com/dtolabs/rundeck/jetty/jaas/JettyCachingLdapLoginModuleTest.java
+++ b/rundeck-launcher/rundeck-jetty-server/src/test/java/com/dtolabs/rundeck/jetty/jaas/JettyCachingLdapLoginModuleTest.java
@@ -74 +74,17 @@
-        JettyCachingLdapLoginModule module = getJettyCachingLdapLoginModule();
+        JettyCachingLdapLoginModule module = getJettyCachingLdapLoginModule(false);
+        module._nestedGroups = true;
+        try {
+            UserInfo userInfo = module.getUserInfo(user1);
+            assertThat(userInfo.getUserName(), is(user1));
+
+            List<String> actualRoles = userInfo.getRoleNames();
+            List<String> expectedRoles = Arrays.asList(role1, role2, nestedRole1);
+            assertThat(actualRoles, is(expectedRoles));
+        } catch (Exception e) {
+            e.printStackTrace();
+        }
+    }
+
+    @Test
+    public void testShouldGetNestedGroupsWithAD() {
+        JettyCachingLdapLoginModule module = getJettyCachingLdapLoginModule(true);
@@ -90 +106 @@
-        JettyCachingLdapLoginModule module = getJettyCachingLdapLoginModule();
+        JettyCachingLdapLoginModule module = getJettyCachingLdapLoginModule(false);
@@ -104 +120 @@
-    private JettyCachingLdapLoginModule getJettyCachingLdapLoginModule() {
+    private JettyCachingLdapLoginModule getJettyCachingLdapLoginModule(boolean activeDirectory) {
@@ -190 +206,6 @@
-            when(nestedRole1Members.next()).thenReturn("cn=" + role1 + "," + module._roleBaseDn, "uid=" + user2 + "," + module._roleBaseDn);
+            if(activeDirectory) {
+                when(nestedRole1Members.next()).thenReturn("CN=" + role1 + "," + module._roleBaseDn, "uid=" + user2 + "," + module._roleBaseDn);
+            } else {
+                when(nestedRole1Members.next()).thenReturn("cn=" + role1 + "," + module._roleBaseDn, "uid=" + user2 + "," + module._roleBaseDn);
+            }
+
@@ -199 +219,0 @@
-

