diff --git a/archiva-modules/archiva-web/archiva-webapp/src/test/java/org/apache/maven/archiva/web/action/AbstractActionTestCase.java b/archiva-modules/archiva-web/archiva-webapp/src/test/java/org/apache/maven/archiva/web/action/AbstractActionTestCase.java
index c5c2da0..9a95ce5 100644
--- a/archiva-modules/archiva-web/archiva-webapp/src/test/java/org/apache/maven/archiva/web/action/AbstractActionTestCase.java
+++ b/archiva-modules/archiva-web/archiva-webapp/src/test/java/org/apache/maven/archiva/web/action/AbstractActionTestCase.java
@@ -110,2 +110 @@
-        //(UserRepositoriesStub) lookup( UserRepositories.class );
-        UserRepositoriesStub repos = applicationContext.getBean( "userRepositories#test", UserRepositoriesStub.class );
+        UserRepositoriesStub repos = applicationContext.getBean( "userRepositories", UserRepositoriesStub.class );
diff --git a/archiva-modules/archiva-web/archiva-webapp/src/test/java/org/apache/maven/archiva/web/action/BrowseActionTest.java b/archiva-modules/archiva-web/archiva-webapp/src/test/java/org/apache/maven/archiva/web/action/BrowseActionTest.java
index 394d04e..2b5c6c0 100644
--- a/archiva-modules/archiva-web/archiva-webapp/src/test/java/org/apache/maven/archiva/web/action/BrowseActionTest.java
+++ b/archiva-modules/archiva-web/archiva-webapp/src/test/java/org/apache/maven/archiva/web/action/BrowseActionTest.java
@@ -21,0 +22 @@
+import com.google.common.collect.Lists;
@@ -392,0 +394 @@
+        setObservableRepos( Lists.<String>newArrayList( "test-repo" ) );
@@ -401,0 +404,7 @@
+
+    protected void tearDown()
+        throws Exception
+    {
+        super.tearDown();
+        setObservableRepos( Lists.<String>newArrayList( "test-repo" ) );
+    }
diff --git a/archiva-modules/archiva-web/archiva-webapp/src/test/java/org/apache/maven/archiva/web/action/admin/repositories/RepositoriesActionTest.java b/archiva-modules/archiva-web/archiva-webapp/src/test/java/org/apache/maven/archiva/web/action/admin/repositories/RepositoriesActionTest.java
index 2a489e6..b21e0e5 100644
--- a/archiva-modules/archiva-web/archiva-webapp/src/test/java/org/apache/maven/archiva/web/action/admin/repositories/RepositoriesActionTest.java
+++ b/archiva-modules/archiva-web/archiva-webapp/src/test/java/org/apache/maven/archiva/web/action/admin/repositories/RepositoriesActionTest.java
@@ -53 +53 @@
-        action = (RepositoriesAction) getActionProxy( "/admin/index.action"  ).getAction();
+        action = (RepositoriesAction) getActionProxy( "/admin/index.action" ).getAction();
@@ -70,3 +70,3 @@
-        control.expectAndReturn( metadataRepository.getMetadataFacet( "internal", RepositoryStatistics.FACET_ID,
-                                                                      "20091125.123456.678" ),
-                                 new RepositoryStatistics() );
+        control.expectAndReturn(
+            metadataRepository.getMetadataFacet( "internal", RepositoryStatistics.FACET_ID, "20091125.123456.678" ),
+            new RepositoryStatistics() );
@@ -75,3 +75,3 @@
-        control.expectAndReturn( metadataRepository.getMetadataFacet( "snapshots", RepositoryStatistics.FACET_ID,
-                                                                      "20091112.012345.012" ),
-                                 new RepositoryStatistics() );
+        control.expectAndReturn(
+            metadataRepository.getMetadataFacet( "snapshots", RepositoryStatistics.FACET_ID, "20091112.012345.012" ),
+            new RepositoryStatistics() );
@@ -82,2 +82,2 @@
-        //TestRepositorySessionFactory factory = (TestRepositorySessionFactory) lookup( RepositorySessionFactory.class );
-        TestRepositorySessionFactory factory = new TestRepositorySessionFactory();
+        TestRepositorySessionFactory factory =
+            applicationContext.getBean( "repositorySessionFactory#test", TestRepositorySessionFactory.class );

