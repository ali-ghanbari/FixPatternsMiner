diff --git a/tycho-bundles/org.eclipse.tycho.p2.maven.repository.tests/src/test/java/org/eclipse/tycho/p2/maven/repository/tests/MavenMirrorRequestTest.java b/tycho-bundles/org.eclipse.tycho.p2.maven.repository.tests/src/test/java/org/eclipse/tycho/p2/maven/repository/tests/MavenMirrorRequestTest.java
index 9e0a8b3..6fbabe7 100644
--- a/tycho-bundles/org.eclipse.tycho.p2.maven.repository.tests/src/test/java/org/eclipse/tycho/p2/maven/repository/tests/MavenMirrorRequestTest.java
+++ b/tycho-bundles/org.eclipse.tycho.p2.maven.repository.tests/src/test/java/org/eclipse/tycho/p2/maven/repository/tests/MavenMirrorRequestTest.java
@@ -13,0 +14 @@
+import java.util.jar.JarFile;
@@ -21,0 +23 @@
+import org.eclipse.equinox.p2.repository.artifact.IArtifactDescriptor;
@@ -74 +76 @@
-        MavenMirrorRequest request = new MavenMirrorRequest(key, localRepository, transport, false);
+        MavenMirrorRequest request = new MavenMirrorRequest(key, localRepository, transport, true);
@@ -78 +80,15 @@
-        Assert.assertEquals(1, localRepository.getArtifactDescriptors(key).length);
+        IArtifactDescriptor[] descriptors = localRepository.getArtifactDescriptors(key);
+        Assert.assertEquals(2, descriptors.length);
+        Assert.assertNotNull(getDescriptor(descriptors, null)); // canonical
+        Assert.assertNotNull(getDescriptor(descriptors, IArtifactDescriptor.FORMAT_PACKED));
+
+        File file = localRepository.getArtifactFile(getDescriptor(descriptors, null));
+        Assert.assertTrue(file.isFile() && file.canRead());
+
+        // make sure this is actually a jar
+        JarFile jar = new JarFile(file);
+        try {
+            Assert.assertNotNull(jar.getManifest());
+        } finally {
+            jar.close();
+        }
@@ -80,0 +97,17 @@
+    private IArtifactDescriptor getDescriptor(IArtifactDescriptor[] descriptors, String format) {
+        if (descriptors == null) {
+            return null;
+        }
+
+        for (IArtifactDescriptor descriptor : descriptors) {
+            if (format != null) {
+                if (format.equals(descriptor.getProperty(IArtifactDescriptor.FORMAT))) {
+                    return descriptor;
+                }
+            } else if (descriptor.getProperty(IArtifactDescriptor.FORMAT) == null) {
+                return descriptor;
+            }
+        }
+
+        return null;
+    }
diff --git a/tycho-bundles/org.eclipse.tycho.p2.maven.repository/src/main/java/org/eclipse/tycho/p2/maven/repository/MavenMirrorRequest.java b/tycho-bundles/org.eclipse.tycho.p2.maven.repository/src/main/java/org/eclipse/tycho/p2/maven/repository/MavenMirrorRequest.java
index bbea0aa..20f00b5 100644
--- a/tycho-bundles/org.eclipse.tycho.p2.maven.repository/src/main/java/org/eclipse/tycho/p2/maven/repository/MavenMirrorRequest.java
+++ b/tycho-bundles/org.eclipse.tycho.p2.maven.repository/src/main/java/org/eclipse/tycho/p2/maven/repository/MavenMirrorRequest.java
@@ -97,0 +98 @@
+        targetDescriptor.setProperty(IArtifactDescriptor.FORMAT, null);

