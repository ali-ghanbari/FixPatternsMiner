fix #226, #224, #223

