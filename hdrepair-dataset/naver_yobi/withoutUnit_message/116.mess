fixed to use try-finally

