add array accessor test classes and fix related bugs

This used to be revision r1950.

