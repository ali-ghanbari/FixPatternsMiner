diff --git a/src/org/pentaho/di/trans/steps/excelwriter/ExcelWriterStep.java b/src/org/pentaho/di/trans/steps/excelwriter/ExcelWriterStep.java
index 5695501..6a46dd3 100644
--- a/src/org/pentaho/di/trans/steps/excelwriter/ExcelWriterStep.java
+++ b/src/org/pentaho/di/trans/steps/excelwriter/ExcelWriterStep.java
@@ -673,0 +674,2 @@
+			} else {
+			  data.wb = new HSSFWorkbook(KettleVFS.getInputStream(data.file));

