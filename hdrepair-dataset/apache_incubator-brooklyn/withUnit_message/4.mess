Adds ArchiveUtilsTest + fixes ArchiveUtils

- Fixes case where optionalTmpDir not supplied
- Adds various test cases

