code review, and fixing failing test and rat checks

