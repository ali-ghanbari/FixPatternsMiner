updated dependencies and fixed code accordingly

