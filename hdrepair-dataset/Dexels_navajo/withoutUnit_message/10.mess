fixed a bug in multithread part
