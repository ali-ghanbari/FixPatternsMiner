diff --git a/whois-endtoend/src/test/groovy/net/ripe/db/whois/spec/domain/AckResponse.groovy b/whois-endtoend/src/test/groovy/net/ripe/db/whois/spec/domain/AckResponse.groovy
index 40b43e3..508bb5c 100644
--- a/whois-endtoend/src/test/groovy/net/ripe/db/whois/spec/domain/AckResponse.groovy
+++ b/whois-endtoend/src/test/groovy/net/ripe/db/whois/spec/domain/AckResponse.groovy
@@ -58 +58 @@
-            println "ERRORS section string[\n" + matcher.group(3) + "\n]"
+//            println "ERRORS section string[\n" + matcher.group(3) + "\n]"
@@ -95 +95 @@
-            println "SUCCESS section string[\n" + matcher.group(3) + "\n]"
+//            println "SUCCESS section string[\n" + matcher.group(3) + "\n]"
@@ -113 +113 @@
-            println "PENDING section string[\n" + matcher.group(3) + "\n]"
+//            println "PENDING section string[\n" + matcher.group(3) + "\n]"
diff --git a/whois-endtoend/src/test/groovy/net/ripe/db/whois/spec/update/PendingRouteSpec.groovy b/whois-endtoend/src/test/groovy/net/ripe/db/whois/spec/update/PendingRouteSpec.groovy
index 185d420..861ad00 100644
--- a/whois-endtoend/src/test/groovy/net/ripe/db/whois/spec/update/PendingRouteSpec.groovy
+++ b/whois-endtoend/src/test/groovy/net/ripe/db/whois/spec/update/PendingRouteSpec.groovy
@@ -791 +791 @@
-    def "create route, mnt-by & parent inet pw supplied, ASN pw supplied 2 weeks later"() {
+    def "create route, mnt-by & parent inet pw supplied, mnt-by & ASN pw supplied 2 weeks later"() {
@@ -802,2 +802,2 @@
-        getTestDateTimeProvider().setTime(new LocalDateTime().minusWeeks(2))
-        syncUpdate("""\
+        whoisFixture.getTestDateTimeProvider().setTime(new LocalDateTime().minusWeeks(2))
+        def message = syncUpdate(new SyncUpdate(data: """\
@@ -813 +813,2 @@
-                """.stripIndent())
+                """.stripIndent(), redirect: false)
+        )
@@ -815 +815,0 @@
-        getTestDateTimeProvider().reset()
@@ -817,2 +817,25 @@
-        DatabaseHelper.dumpSchema(databaseHelper.getInternalsTemplate().getDataSource())
-        ((PendingUpdatesCleanup)getApplicationContext().getBean("pendingUpdatesCleanup")).run()
+      then:
+        def ack = new AckResponse("", message)
+
+        ack.summary.nrFound == 1
+        ack.summary.assertSuccess(1, 0, 0, 0, 1)
+        ack.summary.assertErrors(0, 0, 0, 0)
+        ack.countErrorWarnInfo(0, 1, 2)
+        ack.successes.any { it.operation == "Create PENDING" && it.key == "[route] 192.168.0.0/16AS100" }
+        ack.warningPendingMessagesFor("Create", "[route] 192.168.0.0/16AS100") ==
+                ["This update has only passed one of the two required hierarchical authorisations"]
+        ack.infoPendingMessagesFor("Create", "[route] 192.168.0.0/16AS100") ==
+                ["Authorisation for [aut-num] AS100 failed using \"mnt-by:\" not authenticated by: RIPE-NCC-END-MNT, AS-MNT",
+                        "The route object 192.168.0.0/16AS100 will be saved for one week pending the second authorisation"]
+
+        def notif = notificationFor "updto_as@ripe.net"
+        notif.subject =~ "RIPE Database updates, auth request notification"
+        notif.pendingAuth("CREATE", "route", "192.168.0.0/16")
+
+        noMoreMessages()
+        queryObjectNotFound("-rGBT route 192.168.0.0/16", "route", "192.168.0.0/16")
+
+      when:
+        whoisFixture.getTestDateTimeProvider().reset()
+//        DatabaseHelper.dumpSchema(databaseHelper.getInternalsTemplate().getDataSource())
+        ((PendingUpdatesCleanup)whoisFixture.getApplicationContext().getBean("pendingUpdatesCleanup")).run()
@@ -826 +849 @@
-      def pending = send new Message(
+        def pending = send new Message(
@@ -842 +865 @@
-        def ack = ackFor pending
+        def ack3 = ackFor pending
@@ -844,6 +867,6 @@
-        ack.summary.nrFound == 1
-        ack.summary.assertSuccess(1, 0, 0, 0, 1)
-        ack.summary.assertErrors(0, 0, 0, 0)
-        ack.countErrorWarnInfo(0, 1, 2)
-        ack.successes.any { it.operation == "Create PENDING" && it.key == "[route] 192.168.0.0/16AS100" }
-        ack.warningPendingMessagesFor("Create", "[route] 192.168.0.0/16AS100") ==
+        ack3.summary.nrFound == 1
+        ack3.summary.assertSuccess(1, 0, 0, 0, 1)
+        ack3.summary.assertErrors(0, 0, 0, 0)
+        ack3.countErrorWarnInfo(0, 1, 2)
+        ack3.successes.any { it.operation == "Create PENDING" && it.key == "[route] 192.168.0.0/16AS100" }
+        ack3.warningPendingMessagesFor("Create", "[route] 192.168.0.0/16AS100") ==
@@ -851 +874 @@
-        ack.infoPendingMessagesFor("Create", "[route] 192.168.0.0/16AS100") ==
+        ack3.infoPendingMessagesFor("Create", "[route] 192.168.0.0/16AS100") ==
@@ -864 +887 @@
-    def "create route, mnt-by & ASN pw supplied, p inet pw supplied 2 weeks later"() {
+    def "create route, mnt-by & ASN pw supplied, pinet pw supplied 2 weeks later"() {
@@ -875,2 +898,2 @@
-        getTestDateTimeProvider().setTime(new LocalDateTime().minusWeeks(2))
-        syncUpdate("""\
+        whoisFixture.getTestDateTimeProvider().setTime(new LocalDateTime().minusWeeks(2))
+        def message = syncUpdate(new SyncUpdate(data: """\
@@ -886 +909,2 @@
-                """.stripIndent())
+                """.stripIndent(), redirect: false)
+        )
@@ -888 +912,2 @@
-        getTestDateTimeProvider().reset()
+        then:
+        def ack = new AckResponse("", message)
@@ -890,2 +915,21 @@
-        DatabaseHelper.dumpSchema(databaseHelper.getInternalsTemplate().getDataSource())
-        ((PendingUpdatesCleanup)getApplicationContext().getBean("pendingUpdatesCleanup")).run()
+        ack.summary.nrFound == 1
+        ack.summary.assertSuccess(1, 0, 0, 0, 1)
+        ack.summary.assertErrors(0, 0, 0, 0)
+        ack.countErrorWarnInfo(0, 1, 2)
+        ack.successes.any { it.operation == "Create PENDING" && it.key == "[route] 192.168.0.0/16AS100" }
+        ack.warningPendingMessagesFor("Create", "[route] 192.168.0.0/16AS100") ==
+                ["This update has only passed one of the two required hierarchical authorisations"]
+        ack.infoPendingMessagesFor("Create", "[route] 192.168.0.0/16AS100") ==
+                ["Authorisation for [inetnum] 192.168.0.0 - 192.169.255.255 failed using \"mnt-lower:\" not authenticated by: P-INET-MNT",
+                        "The route object 192.168.0.0/16AS100 will be saved for one week pending the second authorisation"]
+
+        def notif = notificationFor "updto_pinet@ripe.net"
+        notif.subject =~ "RIPE Database updates, auth request notification"
+        notif.pendingAuth("CREATE", "route", "192.168.0.0/16")
+
+        noMoreMessages()
+        queryObjectNotFound("-rGBT route 192.168.0.0/16", "route", "192.168.0.0/16")
+
+        when:
+        whoisFixture.getTestDateTimeProvider().reset()
+        ((PendingUpdatesCleanup)whoisFixture.getApplicationContext().getBean("pendingUpdatesCleanup")).run()
@@ -914 +958 @@
-        def ack = ackFor pending
+        def ack3 = ackFor pending
@@ -916,5 +960,8 @@
-        ack.summary.nrFound == 1
-        ack.summary.assertSuccess(0, 0, 0, 0, 0)
-        ack.summary.assertErrors(1, 1, 0, 0)
-        ack.countErrorWarnInfo(2, 0, 0)
-        ack.errors.any { it.operation == "Create" && it.key == "[route] 192.168.0.0/16AS100" }
+        ack3.summary.nrFound == 1
+        ack3.summary.assertSuccess(0, 0, 0, 0, 0)
+        ack3.summary.assertErrors(1, 1, 0, 0)
+        ack3.countErrorWarnInfo(2, 0, 0)
+        ack3.errors.any { it.operation == "Create" && it.key == "[route] 192.168.0.0/16AS100" }
+        ack3.errorMessagesFor("Create", "[route] 192.168.0.0/16AS100") ==
+                ["Authorisation for [route] 192.168.0.0/16AS100 failed using \"mnt-by:\" not authenticated by: OWNER-MNT",
+                        "Authorisation for [aut-num] AS100 failed using \"mnt-by:\" not authenticated by: RIPE-NCC-END-MNT, AS-MNT"]
@@ -922,2 +969,2 @@
-        def notif = notificationFor "updto_owner@ripe.net"
-        notif.subject =~ "RIPE Database updates, auth error notification"
+        def notif3 = notificationFor "updto_owner@ripe.net"
+        notif3.subject =~ "RIPE Database updates, auth error notification"
diff --git a/whois-update/src/test/java/net/ripe/db/whois/update/mail/MailSenderStub.java b/whois-update/src/test/java/net/ripe/db/whois/update/mail/MailSenderStub.java
index c6d12ec..cf2646e 100644
--- a/whois-update/src/test/java/net/ripe/db/whois/update/mail/MailSenderStub.java
+++ b/whois-update/src/test/java/net/ripe/db/whois/update/mail/MailSenderStub.java
@@ -43 +43 @@
-            LOGGER.info("Send message: {}\n\n{}\n\n", EnumerationUtils.toList(mimeMessage.getAllHeaderLines()), mimeMessage.getContent());
+//            LOGGER.info("Send message: {}\n\n{}\n\n", EnumerationUtils.toList(mimeMessage.getAllHeaderLines()), mimeMessage.getContent());

