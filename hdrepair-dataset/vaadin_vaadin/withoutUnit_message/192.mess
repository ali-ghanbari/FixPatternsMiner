enhanced fix for #932

svn changeset:6361/svn branch:trunk

