fix decommission for on_demand and run_once

- add tests

