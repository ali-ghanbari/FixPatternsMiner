fixed some bugs during testing
