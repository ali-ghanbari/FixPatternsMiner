diff --git a/web/src/main/java/de/betterform/agent/web/WebFactory.java b/web/src/main/java/de/betterform/agent/web/WebFactory.java
index 429c00e..372fddc 100644
--- a/web/src/main/java/de/betterform/agent/web/WebFactory.java
+++ b/web/src/main/java/de/betterform/agent/web/WebFactory.java
@@ -224 +224 @@
-        String pathToXSLDirectory = resolvePath.substring(0, resolvePath.lastIndexOf("/"));
+        String pathToXSLDirectory = resolvePath.substring(0, resolvePath.lastIndexOf(File.separator));
diff --git a/web/src/test/java/de/betterform/agent/web/WebFactoryTest.java b/web/src/test/java/de/betterform/agent/web/WebFactoryTest.java
new file mode 100644
index 0000000..fab00fb
--- /dev/null
+++ b/web/src/test/java/de/betterform/agent/web/WebFactoryTest.java
@@ -0,0 +1,25 @@
+package de.betterform.agent.web;
+
+import static org.hamcrest.CoreMatchers.is;
+import static org.junit.Assert.*;
+
+import org.junit.Test;
+
+import java.net.URI;
+import java.net.URISyntaxException;
+
+public class WebFactoryTest {
+
+    @Test
+    public void testGetXsltURI() throws URISyntaxException {
+
+        WebFactory wf = new WebFactory();
+
+        URI uri = wf.getXsltURI("/some/path/", "file.xsl");
+
+        assertThat(uri.getScheme(), is("file"));
+        assertTrue(uri.toString().endsWith("/web/some/file.xsl"));
+
+    }
+
+}

