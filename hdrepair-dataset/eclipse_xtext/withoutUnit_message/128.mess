fixed a bug, thx to Ed Willink for code review.

