Bug fix: recursive function leads to endless loop.


