bugfix: correctly calculate destination in the presence of invisible viewstates


