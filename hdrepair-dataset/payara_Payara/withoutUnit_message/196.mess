Additional fix for 14785

The earlier fix for this issue caused problems when the server ran with the security manager.  The approach used in these changes avoids that.

git-svn-id: https://svn.java.net/svn/glassfish~svn/trunk/main@53753 6f3ba3e3-413c-0410-a8aa-90bee3ab43b5

