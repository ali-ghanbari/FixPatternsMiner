Fix for DIRMINA-1008: fix broken algorithm

