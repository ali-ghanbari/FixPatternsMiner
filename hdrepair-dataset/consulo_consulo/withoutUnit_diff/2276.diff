diff --git a/openapi/src/com/intellij/openapi/vfs/VfsUtil.java b/openapi/src/com/intellij/openapi/vfs/VfsUtil.java
index 75ccaeb..8f92700 100644
--- a/openapi/src/com/intellij/openapi/vfs/VfsUtil.java
+++ b/openapi/src/com/intellij/openapi/vfs/VfsUtil.java
@@ -510 +510 @@
-    if( idx >= 0 && url.charAt(idx+2) != '/' ) {
+    if( idx >= 0 && (idx+2) < url.length() && url.charAt(idx+2) != '/' ) {

