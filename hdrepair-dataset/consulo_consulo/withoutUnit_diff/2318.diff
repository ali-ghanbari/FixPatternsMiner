diff --git a/compiler/impl/com/intellij/openapi/deployment/LibraryLinkImpl.java b/compiler/impl/com/intellij/openapi/deployment/LibraryLinkImpl.java
index 92f0ac6..0b45857 100644
--- a/compiler/impl/com/intellij/openapi/deployment/LibraryLinkImpl.java
+++ b/compiler/impl/com/intellij/openapi/deployment/LibraryLinkImpl.java
@@ -229 +229 @@
-    if (outputPath != null && LibraryLink.MODULE_LEVEL.equals(getLevel()) && urls.size() == 1
+    if (outputPath != null && !outputPath.endsWith(JAR_SUFFIX) && LibraryLink.MODULE_LEVEL.equals(getLevel()) && urls.size() == 1

