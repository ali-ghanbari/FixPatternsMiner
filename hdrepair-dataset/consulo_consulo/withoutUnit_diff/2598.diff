diff --git a/dom/impl/src/com/intellij/util/xml/highlighting/DomElementsProblemsHolderImpl.java b/dom/impl/src/com/intellij/util/xml/highlighting/DomElementsProblemsHolderImpl.java
index e8ff57f..3249414 100644
--- a/dom/impl/src/com/intellij/util/xml/highlighting/DomElementsProblemsHolderImpl.java
+++ b/dom/impl/src/com/intellij/util/xml/highlighting/DomElementsProblemsHolderImpl.java
@@ -184 +184 @@
-        if (!reference.isSoft() && reference.resolve() == null) {
+        if (!reference.isSoft() && XmlHighlightVisitor.hasBadResolve(reference)) {

