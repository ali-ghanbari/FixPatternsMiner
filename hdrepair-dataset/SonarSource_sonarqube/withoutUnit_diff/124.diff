diff --git a/plugins/sonar-core-gwt/src/main/java/org/sonar/plugins/core/violationsviewer/client/ViolationsViewer.java b/plugins/sonar-core-gwt/src/main/java/org/sonar/plugins/core/violationsviewer/client/ViolationsViewer.java
index 137ad9f..71f43a8 100644
--- a/plugins/sonar-core-gwt/src/main/java/org/sonar/plugins/core/violationsviewer/client/ViolationsViewer.java
+++ b/plugins/sonar-core-gwt/src/main/java/org/sonar/plugins/core/violationsviewer/client/ViolationsViewer.java
@@ -67,0 +68,2 @@
+    sourcePanel = null; // reload sources when selecting a new file
+
diff --git a/tests/integration/tests/src/test/selenium/SONAR-684-encode-violation-messages.html b/tests/integration/tests/src/test/selenium/SONAR-684-encode-violation-messages.html
index 583b247..12235c7 100644
--- a/tests/integration/tests/src/test/selenium/SONAR-684-encode-violation-messages.html
+++ b/tests/integration/tests/src/test/selenium/SONAR-684-encode-violation-messages.html
@@ -35 +35 @@
-	<td>assertText</td>
+	<td>waitForText</td>
@@ -39 +38,0 @@
-

