diff --git a/common/src/geogebra/common/cas/mpreduce/Ggb2MPReduce.java b/common/src/geogebra/common/cas/mpreduce/Ggb2MPReduce.java
index 453c5ff..1aaab7c 100644
--- a/common/src/geogebra/common/cas/mpreduce/Ggb2MPReduce.java
+++ b/common/src/geogebra/common/cas/mpreduce/Ggb2MPReduce.java
@@ -266 +266 @@
-				"<<begin scalar tmpcolumn!!; clear tmpmatrix!!; tmpmatrix!!:=(%0)$ tmpcolumn!!:=1$ for i:=1:row\\_dim(tmpmatrix!!) do <<if tmpcolumn!!<column\\_dim(tmpmatrix!!) and tmpmatrix!!(i,tmpcolumn!!)=0 then while (tmpcolumn!!<=column\\_dim(tmpmatrix!!) and tmpmatrix!!(i,tmpcolumn!!)=0 and i<=row\\_dim(tmpmatrix!!)) do << for j:=i+1:row\\_dim(tmpmatrix!!) do if (j<=column\\_dim(tmpmatrix!!) and tmpmatrix!!(i,j) neq 0) then tmpmatrix!!:=swap\\_rows(tmpmatrix!!,tmpcolumn!!, j)$ if (tmpmatrix!!(i,tmpcolumn!!)=0) then tmpcolumn!!:=tmpcolumn!!+1 >>$ if tmpcolumn!!<=column\\_dim(tmpmatrix!!) then if tmpmatrix!!(i, tmpcolumn!!) neq 0 then << tmpmatrix!!:=pivot(tmpmatrix!!,i,tmpcolumn!!); tmpmatrix!!:=mult\\_rows(tmpmatrix!!,i,1/tmpmatrix!!(i,tmpcolumn!!))$ tmpcolumn!!:=tmpcolumn!!+1 >>; >>$ return tmpmatrix!! end>>");
+				"<<begin scalar tmpcolumn!!, nrows!!, ncolumns!!, row!!;clear tmpmatrix!!; tmpmatrix!!:=(%0)$ nrows!!:=row\\_dim(tmpmatrix!!); ncolums!!:=column\\_dim(tmpmatrix!!);tmpcolumn!!:=1$ for i:=1:nrows!! do << row!!:=i;  if tmpcolumn!!<=nrows!! then while (tmpcolumn!!<=nrows!! and tmpmatrix!!(row!!,tmpcolumn!!)=0) do << row!!:=row!!+1;if row!!>nrows!! then << row!!:=i;tmpcolumn!!:=tmpcolumn!!+1>>>>; if tmpcolumn!!<=nrows!! then <<tmpmatrix!!:=swap\\_rows(tmpmatrix!!,i,row!!);tmpmatrix!!:=mult\\_rows(tmpmatrix!!,i,1/tmpmatrix!!(i,tmpcolumn!!));tmpmatrix!!:=pivot(tmpmatrix!!,i,tmpcolumn!!)>>>>$ return tmpmatrix!! end>>");

