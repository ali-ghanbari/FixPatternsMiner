[bugfix] Make sure the query rewriter does not silently fail (or fail with maxClauseCount exceeded) but chooses the most suitable one depending on terms and docs quote which the static one does not do.

