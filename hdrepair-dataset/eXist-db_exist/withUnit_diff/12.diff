diff --git a/src/org/exist/storage/NodePath.java b/src/org/exist/storage/NodePath.java
index aa1491e..cb983ed 100644
--- a/src/org/exist/storage/NodePath.java
+++ b/src/org/exist/storage/NodePath.java
@@ -120 +120,2 @@
-            if(other.components[j].compareTo(components[i]) == 0) {
+            if(other.components[j].compareTo(components[i]) == 0 && (j + 1 == other.pos || other.components[j + 1].compareTo(components[i]) != 0)) {
+           // if(other.components[j].compareTo(components[i]) == 0) {
diff --git a/test/src/org/exist/xmldb/CollectionConfigurationTest.java b/test/src/org/exist/xmldb/CollectionConfigurationTest.java
index b08a50c..03e3352 100644
--- a/test/src/org/exist/xmldb/CollectionConfigurationTest.java
+++ b/test/src/org/exist/xmldb/CollectionConfigurationTest.java
@@ -47 +47 @@
-    private final static String DOCUMENT_CONTENT2 = "<test >" + "<c c='2002-12-07T12:20:46.275+01:00'>2002-12-07T12:20:46.275+01:00</c>"
+    private final static String DOCUMENT_CONTENT2 = "<test x='0'>" + "<c c='2002-12-07T12:20:46.275+01:00'>2002-12-07T12:20:46.275+01:00</c>"
@@ -49 +49 @@
-    + "</test>";
+    + "<test x='1'><test x='2'></test></test></test>";
@@ -74,0 +75 @@
+        + "    <create path=\"//test/@x\" type=\"xs:integer\"/>"
@@ -818,0 +820,12 @@
+          
+           result = service.query("//test[@x = 0]");
+           assertEquals(1, result.getSize());
+           
+           result = service.query("//test[@x eq 0]");
+           assertEquals(1, result.getSize());
+           
+           result = service.query("//test[(# exist:force-index-use #) { @x = 0 }]");
+           assertEquals(1, result.getSize());
+           
+           result = service.query("//test[(# exist:force-index-use #) { @x eq 0 }]");
+           assertEquals(1, result.getSize());
@@ -974 +987 @@
-           assertEquals(1, result.getSize());           
+           assertEquals(1, result.getSize());

