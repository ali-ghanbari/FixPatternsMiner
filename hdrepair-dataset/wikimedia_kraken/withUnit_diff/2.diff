diff --git a/kraken-generic/src/main/java/org/wikimedia/analytics/kraken/pageview/UserAgent.java b/kraken-generic/src/main/java/org/wikimedia/analytics/kraken/pageview/UserAgent.java
index 518085f..a287b49 100644
--- a/kraken-generic/src/main/java/org/wikimedia/analytics/kraken/pageview/UserAgent.java
+++ b/kraken-generic/src/main/java/org/wikimedia/analytics/kraken/pageview/UserAgent.java
@@ -46 +46 @@
-    private static final Pattern WMF_APP_IOS            = Pattern.compile("Mozilla/5.0(?!Safari).*iPhone(?!Safari).*");
+    private static final Pattern WMF_APP_IOS            = Pattern.compile("Mozilla/5.0(?!.*\\bSafari\\b).*iPhone(?!.*\\bSafari\\b).*");
diff --git a/kraken-pig/src/test/java/org/wikimedia/analytics/kraken/pig/UserAgentClassifierTest.java b/kraken-pig/src/test/java/org/wikimedia/analytics/kraken/pig/UserAgentClassifierTest.java
index 88f6d39..0ca267a 100644
--- a/kraken-pig/src/test/java/org/wikimedia/analytics/kraken/pig/UserAgentClassifierTest.java
+++ b/kraken-pig/src/test/java/org/wikimedia/analytics/kraken/pig/UserAgentClassifierTest.java
@@ -76 +76 @@
-    
+
@@ -80,0 +81 @@
+
@@ -83,0 +85,8 @@
+
+        input.set(0, "Mozilla/5.0 (iPhone; CPU Safari iPhone OS 6_1 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B142");
+        output = ua.exec(input);
+        assertEquals(null, output.get(7));
+
+        input.set(0, "Mozilla/5.0 (iPhone; CPU iPhone OS 6_1 like Mac OS X) Safari AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B142");
+        output = ua.exec(input);
+        assertEquals(null, output.get(7));

