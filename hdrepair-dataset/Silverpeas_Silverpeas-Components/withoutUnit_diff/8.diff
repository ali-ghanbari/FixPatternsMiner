diff --git a/kmelia/kmelia-war/src/main/java/org/silverpeas/kmelia/jstl/KmeliaDisplayHelper.java b/kmelia/kmelia-war/src/main/java/org/silverpeas/kmelia/jstl/KmeliaDisplayHelper.java
index 1f5814a..63871b5 100644
--- a/kmelia/kmelia-war/src/main/java/org/silverpeas/kmelia/jstl/KmeliaDisplayHelper.java
+++ b/kmelia/kmelia-war/src/main/java/org/silverpeas/kmelia/jstl/KmeliaDisplayHelper.java
@@ -376 +376 @@
-              + "\" width=20>&nbsp;<A href=\"" + document_version.getAttachmentURL()
+              + "\" width=20>&nbsp;<A href=\"" + webContext+document_version.getAttachmentURL()
diff --git a/kmelia/kmelia-war/src/main/webapp/kmelia/jsp/publicationViewOnly.jsp b/kmelia/kmelia-war/src/main/webapp/kmelia/jsp/publicationViewOnly.jsp
index d9bc4e2..24b383d 100644
--- a/kmelia/kmelia-war/src/main/webapp/kmelia/jsp/publicationViewOnly.jsp
+++ b/kmelia/kmelia-war/src/main/webapp/kmelia/jsp/publicationViewOnly.jsp
@@ -28 +28,2 @@
-<%@ taglib uri="http://www.silverpeas.com/tld/viewGenerator" prefix="view"%>
+<%@ taglib uri="http://www.silverpeas.com/tld/viewGenerator"
+	prefix="view"%>
@@ -35,95 +36,3 @@
-<%@ include file="checkKmelia.jsp" %>
-<%@ include file="modelUtils.jsp" %>
-<%@ include file="topicReport.jsp.inc" %>
-
-
-<%!
- //Icons
-String folderSrc;
-
-void displayUserModelAndAttachmentsView(CompletePublication pubComplete, UserDetail owner, KmeliaSessionController kmeliaScc, ResourceLocator settings, ResourceLocator uploadSettings, ResourceLocator publicationSettings, String m_context, JspWriter out, HttpServletRequest request, HttpServletResponse response, String user_id, String profile, ResourcesWrapper resources) throws IOException, KmeliaException {
-    InfoDetail infos = pubComplete.getInfoDetail();
-    ModelDetail model = pubComplete.getModelDetail();
-    PublicationDetail detail = pubComplete.getPublicationDetail();
-	String status = detail.getStatus();
-    int type = 0;
-    if ( kmeliaScc.isVersionControlled() )
-    {
-        type = 1; // Versioning
-    }
-    out.println("<TABLE border=\"0\" width=\"98%\" align=center>");
-    out.println("<TR><TD align=\"left\">");
-
-	out.println("<span class=txtnav><b>"+EncodeHelper.javaStringToHtmlString(detail.getName(kmeliaScc.getCurrentLanguage()))+"</b></span><BR>");
-
-    out.println("<b>"+EncodeHelper.javaStringToHtmlString(detail.getDescription(kmeliaScc.getCurrentLanguage()))+"<b><BR><BR>");
-
-	String userId = detail.getUpdaterId();
-	if (userId == null || userId.length() == 0)
-		userId = detail.getCreatorId();
-
-	if (userId != null && userId.length() > 0)
-	{
-		UserDetail user = kmeliaScc.getUserDetail(userId);
-		if (user != null) {
-			out.println("</td><td valign=top align=right>");
-			out.println(user.getFirstName()+" "+user.getLastName()+"<br><i>"+resources.getOutputDate(detail.getUpdateDate()));
-			out.println("</i><br/>");
-		}
-	}
-
-    out.println("</TD></TR></table>");
-	out.println("<TABLE border=\"0\" width=\"98%\" align=center>");
-    if (WysiwygController.haveGotWysiwygToDisplay(detail.getPK().getComponentName(), detail.getPK().getId(), kmeliaScc.getCurrentLanguage())) {
-        out.println("<TR><TD>");
-%>
-		<view:displayWysiwyg objectId="<%=detail.getPK().getId()%>" componentId="<%=detail.getPK().getComponentName() %>" language="<%=kmeliaScc.getCurrentLanguage() %>" />
-<%
-        out.println("</TD>");
-        if (! ("bottom".equals(settings.getString("attachmentPosition") ) ) ) {
-	        if (infos != null) {
-				out.println("<TD width=\"25%\" valign=\"top\" align=\"center\">");
-	            out.println("<A NAME=attachments></a>");
-	            KmeliaDisplayHelper.displayUserAttachmentsView(detail, m_context, out, kmeliaScc
-                    .getLanguage(), true, resources);
-				out.println("</TD>");
-	        }
-	    } else {
-	        if (infos != null) {
-		        out.println("</TR><TR>");
-				out.println("<TD valign=\"top\">");
-	            out.println("<A NAME=attachments></a>");
-	            KmeliaDisplayHelper.displayUserAttachmentsView(detail, m_context, out, kmeliaScc
-                    .getLanguage(), false, resources);
-				out.println("</TD>");
-	        }
-	    }
-        out.println("</TR>");
-    } else {
-        if (infos != null) {
-            out.println("<TR><TD align=\"center\">");
-            if (model != null) {
-            	displayViewInfoModel(out, model, infos, resources, publicationSettings, m_context);
-            }
-            out.println("</TD>");
-
-	        if (! ("bottom".equals(settings.getString("attachmentPosition") ) ) ) {
-				out.println("<TD width=\"25%\" valign=\"top\" align=\"center\">");
-				out.println("<A NAME=attachments></a>");
-				KmeliaDisplayHelper.displayUserAttachmentsView(detail, m_context, out,  kmeliaScc.getLanguage(), true, resources);
-				out.println("</TD>");
-		    } else {
-		        out.println("</TR><TR>");
-				out.println("<TD valign=\"top\">");
-	            out.println("<A NAME=attachments></a>");
-	            KmeliaDisplayHelper.displayUserAttachmentsView(detail, m_context, out, kmeliaScc.getLanguage(), false, resources);
-				out.println("</TD>");
-		    }
-            out.println("</TR>");
-        }
-    }
-    out.println("</TABLE>");
-}
-
-// Fin des declarations
-%>
+<%@ include file="checkKmelia.jsp"%>
+<%@ include file="modelUtils.jsp"%>
+<%@ include file="topicReport.jsp.inc"%>
@@ -132,6 +40,0 @@
-  //Icons
-  folderSrc 			= m_context + "/util/icons/component/kmeliaSmall.gif";
-
-  String topicId		= "";
-  String pubName		= "";
-
@@ -142,2 +45,7 @@
-  KmeliaPublication kmeliaPublication = null;
-  UserDetail ownerDetail = null;
+  String folderSrc = m_context + "/util/icons/component/kmeliaSmall.gif";
+  String topicId = "";
+  String pubName = "";
+  String action = "";
+  String path = "";
+  String profile = "user";
+  String checkPath = "";
@@ -145,4 +53,2 @@
-  CompletePublication pubComplete = null;
-  PublicationDetail pubDetail = null;
-  InfoDetail infos = null;
-  ModelDetail model = null;
+  String id =  request.getParameter("Id");
+  String currentLang =  (String) request.getAttribute("Language");
@@ -150,4 +56,3 @@
-String action = "";
-String path = "";
-String profile = "user";
-String checkPath = "";
+  //Vrai si le user connecte est le createur de cette publication ou si il est admin
+  boolean isOwner = false;
+  TopicDetail currentTopic = null;
@@ -155,2 +60 @@
-String id 			=  request.getParameter("Id");
-String currentLang 	=  request.getAttribute("Language");
+  String pathString = "";
@@ -158,3 +62 @@
-//Vrai si le user connecte est le createur de cette publication ou si il est admin
-boolean isOwner = false;
-TopicDetail currentTopic = null;
+  String user_id = kmeliaScc.getUserId();
@@ -162 +64,4 @@
-String pathString = "";
+  //Calcul du chemin de la publication
+  currentTopic = kmeliaScc.getPublicationTopic(id);
+  Collection pathColl = currentTopic.getPath();
+  pathString = displayPath(pathColl, false, 3);
@@ -164,13 +69,6 @@
-String user_id = kmeliaScc.getUserId();
-
-      //Calcul du chemin de la publication
-      currentTopic = kmeliaScc.getPublicationTopic(id);
-      Collection pathColl = currentTopic.getPath();
-	  pathString = displayPath(pathColl, false, 3);
-
-      //Recuperation des parametres de la publication
-	  kmeliaPublication = kmeliaScc.getPublication(id);
- 	  kmeliaScc.setSessionPublication(kmeliaPublication);
-	  pubName = kmeliaScc.getSessionPublication().getDetail().getName(currentLang);
-      pubComplete = kmeliaPublication.getCompleteDetail();
-      ownerDetail = kmeliaPublication.getCreator();
+  //Recuperation des parametres de la publication
+  KmeliaPublication kmeliaPublication = kmeliaScc.getPublication(id);
+  kmeliaScc.setSessionPublication(kmeliaPublication);
+  pubName = kmeliaScc.getSessionPublication().getDetail().getName(currentLang);
+  CompletePublication pubComplete = kmeliaPublication.getCompleteDetail();
+  UserDetail ownerDetail = kmeliaPublication.getCreator();
@@ -178 +76,2 @@
-<HTML>
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
@@ -185,2 +84,4 @@
-<script type="text/javascript" src="<%=m_context%>/util/javaScript/animation.js"></script>
-<script type="text/javascript" src="<%=m_context%>/util/javaScript/dateUtils.js"></script>
+<script type="text/javascript"
+	src="<%=m_context%>/util/javaScript/animation.js"></script>
+<script type="text/javascript"
+	src="<%=m_context%>/util/javaScript/dateUtils.js"></script>
@@ -190,2 +91,2 @@
-        Window window = gef.getWindow();
-        Frame frame = gef.getFrame();
+  Window window = gef.getWindow();
+  Frame frame = gef.getFrame();
@@ -193,6 +94,6 @@
-        BrowseBar browseBar = window.getBrowseBar();
-        browseBar.setDomainName(kmeliaScc.getSpaceLabel());
-        browseBar.setComponentName(kmeliaScc.getComponentLabel());
-        browseBar.setPath(pathString);
-		browseBar.setExtraInformation(pubName);
-		browseBar.setClickable(false);
+  BrowseBar browseBar = window.getBrowseBar();
+  browseBar.setDomainName(kmeliaScc.getSpaceLabel());
+  browseBar.setComponentName(kmeliaScc.getComponentLabel());
+  browseBar.setPath(pathString);
+  browseBar.setExtraInformation(pubName);
+  browseBar.setClickable(false);
@@ -200,2 +101,2 @@
-        out.println(window.printBefore());
-		out.println(frame.printBefore());
+  out.println(window.printBefore());
+  out.println(frame.printBefore());
@@ -203 +104,14 @@
-        displayUserModelAndAttachmentsView(pubComplete, ownerDetail, kmeliaScc, settings, uploadSettings, publicationSettings, m_context, out, request, response, user_id, profile, resources);
+  InfoDetail infos = pubComplete.getInfoDetail();
+  ModelDetail model = pubComplete.getModelDetail();
+  PublicationDetail detail = pubComplete.getPublicationDetail();
+  String status = detail.getStatus();
+  int type = 0;
+  if ( kmeliaScc.isVersionControlled() )
+  {
+    type = 1; // Versioning
+  }
+		
+%>
+	<table border="0" width="98%" align=center>
+		<tr>
+			<td align="left"><span class=txtnav><b><%=EncodeHelper.javaStringToHtmlString(detail.getName(kmeliaScc.getCurrentLanguage()))%></b></span><BR>
@@ -205,2 +119,109 @@
-        out.println(frame.printAfter());
-        out.println(window.printAfter());
+				<b><%=EncodeHelper.javaStringToHtmlString(detail.getDescription(kmeliaScc.getCurrentLanguage()))%><b>
+				<br />
+				<br /> 
+<%
+  String userId = detail.getUpdaterId();
+  if (userId == null || userId.length() == 0) {
+    userId = detail.getCreatorId();
+  }
+
+  if (userId != null && userId.length() > 0) {
+    UserDetail user = kmeliaScc.getUserDetail(userId);
+	if (user != null) {
+%>
+			</td>
+			<td valign=top align=right><%=user.getFirstName()+" "+user.getLastName()%><br />
+			<i><%=resources.getOutputDate(detail.getUpdateDate())%> </i><br /> 
+<%		
+    }
+  }
+%>
+			</td>
+		</tr>
+	</table>
+	
+	<table border="0" width="98%" align=center>
+<%
+  if (WysiwygController.haveGotWysiwygToDisplay(detail.getPK().getComponentName(), detail.getPK().getId(), kmeliaScc.getCurrentLanguage())) {
+%>
+		<tr>
+			<td><view:displayWysiwyg objectId="<%=detail.getPK().getId()%>"
+					componentId="<%=detail.getPK().getComponentName() %>"
+					language="<%=kmeliaScc.getCurrentLanguage() %>" />
+			</td>
+<%
+	if (! ("bottom".equals(settings.getString("attachmentPosition") ) ) ) {
+	  if (infos != null) {
+%>
+			<td width="25%" valign="top" align="center">
+				<a NAME=attachments></a>
+<%		
+		KmeliaDisplayHelper.displayUserAttachmentsView(detail, m_context, out, kmeliaScc
+                    .getLanguage(), true, resources);
+%>
+			</td>
+<% 	
+	  } 
+	} else {
+	  if (infos != null) {
+%>	  
+		</tr>
+		
+		<tr>
+			<td valign="top">
+				<a NAME=attachments></a>
+<% 				
+		KmeliaDisplayHelper.displayUserAttachmentsView(detail, m_context,
+				out, kmeliaScc.getLanguage(), false, resources);
+%>
+			</td>
+<%
+		} 
+	} 
+%>
+		</tr>
+<%
+  } else {
+	if (infos != null) {
+%>      
+		<tr>
+      		<td align="center">
+<%       	
+	  if (model != null) {
+		displayViewInfoModel(out, model, infos, resources, publicationSettings, m_context);
+      }
+%>
+      		</td>
+<% 
+	  if (! ("bottom".equals(settings.getString("attachmentPosition") ) ) ) {
+%>	    
+			<td width="25%" valign="top" align="center">
+				<a NAME=attachments></a>
+<% 		
+		KmeliaDisplayHelper.displayUserAttachmentsView(detail, m_context, out,  kmeliaScc.getLanguage(), true, resources);
+%>
+			</td>
+<% 		
+	  } else {
+%>
+		</tr>
+	
+		<tr>
+			<td valign="top">
+        		<a NAME=attachments></a>
+<%        	
+        KmeliaDisplayHelper.displayUserAttachmentsView(detail, m_context, out, kmeliaScc.getLanguage(), false, resources);
+%>
+			</td>
+<%		
+	  }
+%>
+		</tr>
+<%	
+	}
+  }
+%>		
+	</table>
+<%
+  out.println(frame.printAfter());
+  out.println(window.printAfter()); 
@@ -209 +230 @@
-</HTML>
\ No newline at end of file
+</HTML>

