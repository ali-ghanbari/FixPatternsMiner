core: fix IllegalStateException during error recovery involving illegal input before EOI

