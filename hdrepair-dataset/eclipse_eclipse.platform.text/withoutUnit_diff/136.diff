diff --git a/org.eclipse.jface.text/src/org/eclipse/jface/text/TextViewer.java b/org.eclipse.jface.text/src/org/eclipse/jface/text/TextViewer.java
index 9cd8ed6..865ee9e 100644
--- a/org.eclipse.jface.text/src/org/eclipse/jface/text/TextViewer.java
+++ b/org.eclipse.jface.text/src/org/eclipse/jface/text/TextViewer.java
@@ -1966 +1966 @@
-			if (!r.equals(fLastSentSelection))  {
+			if ((r != null && !r.equals(fLastSentSelection)) || r == null)  {

