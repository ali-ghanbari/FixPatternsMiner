fix boundary indexing outOfRange error
