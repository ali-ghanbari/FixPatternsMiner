fix for issue #3047

