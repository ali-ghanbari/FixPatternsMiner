diff --git a/core/java/android/widget/LinearLayout.java b/core/java/android/widget/LinearLayout.java
index 52a8679..b4e2790 100644
--- a/core/java/android/widget/LinearLayout.java
+++ b/core/java/android/widget/LinearLayout.java
@@ -444 +444 @@
-        if (useLargestChild) {
+        if (useLargestChild && heightMode == MeasureSpec.AT_MOST) {

